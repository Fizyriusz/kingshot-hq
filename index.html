<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kingshot HQ</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body>

    <header>
        <h1 data-translate-key="appTitle">Kingshot HQ - Centrum Dowodzenia</h1>
        <div id="lang-switcher">
            <button data-lang="pl" class="active-lang">PL</button>
            <button data-lang="en">EN</button>
        </div>
        <button id="logout-button" class="hidden" data-translate-key="logout">Wyloguj</button>
    </header>

    <main>
        <div id="auth-view">
            <h2 data-translate-key="loginTitle">Logowanie</h2>
            <form id="login-form">
                <input type="email" id="email" placeholder="Email" required>
                <input type="password" id="password" placeholder="HasÅ‚o" required>
                <button type="submit" data-translate-key="loginButton">Zaloguj</button>
            </form>
            <p id="error-message" class="error"></p>
        </div>

        <div id="app-view" class="hidden">
            <aside id="stats-sidebar">
                <h3 data-translate-key="statisticsTitle">Statystyki</h3>
                <div id="stats-content"></div>
            </aside>

            <div id="main-content">
                <nav id="tab-nav">
                    <button data-tab="members-view" class="active-tab" data-translate-key="tabMembers">CzÅ‚onkowie</button>
                    <button data-tab="events-view" data-translate-key="tabEvents">Eventy</button>
                    <button data-tab="snapshots-view" data-translate-key="tabSnapshots">Snapshoty</button>
                </nav>

                <div id="tab-content">

                    <section id="members-view" class="tab-pane active">
                        <h3 data-translate-key="addSingleMember">Dodaj Pojedynczego CzÅ‚onka</h3>
                        <form id="add-player-form">
                            <input type="text" id="player-name-input" placeholder="Nazwa..." required>
                            <input type="number" id="player-th-input" placeholder="TH..." min="1">
                            <input type="text" id="player-power-input" placeholder="Power...">
                            <select id="player-marches-input">
                                <option value="" selected data-translate-key="marchesPlaceholder">Marsze?</option>
                                <option value="4">4</option>
                                <option value="5">5</option>
                                <option value="6">6</option>
                            </select>
                            <button type="submit" data-translate-key="addButton">Dodaj</button>
                        </form>
                        <hr class="divider">
                        <h3 data-translate-key="syncToolTitle">NarzÄ™dzie Synchronizacji Sojuszu</h3>
                        <form id="sync-players-form">
                            <textarea id="sync-players-input" placeholder="Wklej peÅ‚nÄ… listÄ™ graczy: Nazwa, TH, Power (np. 122,8m)" rows="10"></textarea>
                            <button type="submit" data-translate-key="analyzeButton">Analizuj listÄ™</button>
                        </form>
                        <div id="sync-results-container"></div>
                        <hr class="divider">
                        <div class="member-filters">
                             <label for="member-filter-name" data-translate-key="filterByName">Filtruj po nicku:</label>
                             <input type="text" id="member-filter-name" placeholder="Wpisz nick...">
                             <label for="member-filter-power" data-translate-key="filterByPower">Filtruj po power:</label>
                             <input type="text" id="member-filter-power" placeholder="Wpisz moc...">
                        </div>
                        <div class="view-toggle-container">
                            <label for="show-inactive-toggle" data-translate-key="showInactive">PokaÅ¼ nieaktywnych</label>
                            <input type="checkbox" id="show-inactive-toggle">
                        </div>
                        <div class="sort-controls" aria-label="member-sort">
                            <span data-translate-key="sortBy">Sortuj po:</span>
                            <button data-sort="name" class="sort-button active-sort" data-translate-key="sortName">Nick</button>
                            <button data-sort="th_level" class="sort-button" data-translate-key="sortTH">TH</button>
                            <button data-sort="power_level" class="sort-button" data-translate-key="sortPower">Power</button>
                            <button data-sort="marches" class="sort-button" data-translate-key="sortMarches">Marsze</button>
                            <button id="sort-direction-button" data-direction="asc">ðŸ”¼</button>
                        </div>
                        <h3 id="members-list-header" data-translate-key="activeMembers">Aktywni CzÅ‚onkowie</h3>
                        <div id="players-list-container"></div>
                    </section>

                    <section id="events-view" class="tab-pane hidden">
                        <h3 data-translate-key="manageEvents">ZarzÄ…dzanie Eventami</h3>
                        <form id="add-event-form">
                            <input type="text" id="event-name-input" placeholder="Nazwa nowego eventu" required>
                            <button type="submit" data-translate-key="createEventButton">StwÃ³rz Event</button>
                        </form>
                        <div id="events-list-container">
                            </div>
                    </section>
                    
                    <section id="snapshots-view" class="tab-pane hidden">
                        <h3 data-translate-key="manageSnapshots">ZarzÄ…dzanie Snapshotami</h3>
                        <p data-translate-key="snapshotDescription">Snapshot zapisuje aktualny stan...</p>
                        <button id="create-snapshot-button" class="button-large" data-translate-key="createSnapshotButton">StwÃ³rz nowy snapshot</button>
                        
                        <hr class="divider">

                        <h3 data-translate-key="addHistoricalSnapshotTitle">Dodaj Historyczny Snapshot (RÄ™cznie)</h3>
                        <form id="analyze-snapshot-form"> <div class="player-filters" style="gap: 20px;">
                                <label for="snapshot-date-input" data-translate-key="snapshotSelectDate">Wybierz datÄ™ snapshotu:</label>
                                <input type="date" id="snapshot-date-input" required>
                            </div>
                            <textarea id="snapshot-data-input" placeholder="Wklej listÄ™: Nazwa, TH, Power (np. 122,8m)" rows="10"></textarea>
                            <button type="submit" id="analyze-snapshot-button" data-translate-key="analyzeSnapshotButton">Analizuj Snapshot</button> </form>
                        <div id="snapshot-results-container"></div> <hr class="divider">
                        <h3 data-translate-key="snapshotHistory">Historia SnapshotÃ³w</h3>
                        <div id="snapshots-list-container"></div>
                    </section>
                    
                    </div>
                </div>
            </div>
        </main>

    <div id="stats-modal" class="modal-container hidden">
        <div class="modal-content">
            <button class="modal-close-button">&times;</button>
            <h3 id="stats-modal-title"></h3>
            <div id="stats-modal-player-list"></div>
        </div>
    </div>

    <script type="module" src="main.js"></script>
</body>
</html>